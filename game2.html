<!doctype html> 
<html lang="en"> 
<head> 
    <meta charset="UTF-8" />
    <title>Train</title>
    <script src="//cdn.jsdelivr.net/npm/phaser@3.11.0/dist/phaser.js"></script>
    <style type="text/css">
        body {
            margin: 0;
        }
    </style>
</head>
<body>
    <script type="text/javascript">
        class toaTau{
           constructor(numberToa){
            this.numberToa = numberToa;
        }
    }
    var config = {
        type: Phaser.CANVAS,
        width: 1280,
        height: 600,
        physics: {
            default: 'arcade',
            arcade: {
                gravity: { y: 300 },
                debug: false
            }
        },
        scene: {
            preload: preload,
            create: create,
            update: update
        }
    };
    var number1;
    var number2;
    var number3;
    var number4;

    var game = new Phaser.Game(config);
    var ylcircle1 ;
    var ylcircle2 ;
    var ylcircle3 ;
    var ylcircle4 ;
    var toa1 = new toaTau;
    var toa2 = new toaTau;
    var toa3 = new toaTau;
    var toa4 = new toaTau;
    var color1;
    var train;

    var purpleHalfWidth = 115/2;
    var toaHalfHeight = 90/2;
    var maxDistance = Math.sqrt(purpleHalfWidth*purpleHalfWidth+toaHalfHeight*toaHalfHeight);
    var rightPosition1 = false;
    var color = [];
    var firstNumber = Math.floor(Math.random()*10+1);
    var random = Math.floor(Math.random()*9);
    var previousNumber = firstNumber;
    var checkTangGiam = false;
    var bl;
    var blueText;
    function preload ()
    {   this.load.image('background','background.png');
    this.load.image('train','train.png');
    this.load.image('toa', 'child.png');
    this.load.image('track','track.png');
    this.load.image('ylcircle','ylCircle.png');
    this.load.image('blcircle','blCircle.png');
    this.load.image('brown','brown.png');
    this.load.image('fadedred','fadedred.png');
    this.load.image('purple','purple.png');

}

function create ()
{   


    this.add.image(0,0,'background').setScale(3);
    this.add.image(300,425,'track');
    this.add.image(900,425,'track');
    this.add.image(1200,425,'track');
    color[0] = this.add.image(320,425,'purple');
    color[1] = this.add.image(450,425,'purple');
    color[2] = this.add.image(580,425,'purple');
    color[3] = this.add.image(710,425,'purple');

  

    this.input.addPointer(2);
    toa4 = this.add.sprite(1000, 300, 'toa').setInteractive({ draggable: true });
    toa4.on('drag', function (pointer, dragX, dragY) {     
        this.x = dragX;
        this.y = dragY;
    });

    toa3 = this.add.sprite(800, 200, 'toa').setInteractive({ draggable: true });
    toa3.on('drag', function (pointer, dragX, dragY) {
        this.x = dragX;
        this.y = dragY;
    });

    toa2 = this.add.sprite(600, 300, 'toa').setInteractive({ draggable: true });
    toa2.on('drag', function (pointer, dragX, dragY) {
        this.x = dragX;
        this.y = dragY;
    });

    toa1 = this.add.sprite(400, 200, 'toa').setInteractive({ draggable: true });
    toa1.on('drag', function (pointer, dragX, dragY) {
        this.x = dragX;
        this.y = dragY;
    });



    train = this.add.image(200,400,'train');
    bl =this.add.image(220,345,'blcircle');
    blueText = this.add.text(210,329,firstNumber, { fontSize: '32px', fill: '#000' });
    ylcircle1 = this.add.image(400,150,'ylcircle');
    ylcircle2 = this.add.image(600,250,'ylcircle');
    ylcircle3 = this.add.image(800,150,'ylcircle');
    ylcircle4 = this.add.image(1000,250,'ylcircle');

    if(firstNumber <=4){
     this.add.text(300,50,"sắp xếp các toa tàu theo thứ tự tăng dần",{ fontSize: '32px', fill: '#000' });
     creatNumber();
     checkTangGiam = true;
      }
 else if (firstNumber==5){

    if(random % 2 == 0){
        this.add.text(300,50,"sắp xếp các toa tàu theo thứ tự tăng dần",{ fontSize: '32px', fill: '#000' });
        creatNumber();
        checkTangGiam = true;
    }
    else{
        this.add.text(300,50,"sắp xếp các toa tàu theo thứ tự giảm dần",{ fontSize: '32px', fill: '#000' });   
        creatNumber(); 
        
    }
}
if(firstNumber >5 ){
 this.add.text(300,50,"sắp xếp các toa tàu theo thứ tự giảm dần",{ fontSize: '32px', fill: '#000' });
 creatNumber();
 
}

toa1.numbertoa = this.add.text(390, 140, number1, { fontSize: '32px', fill: '#000' });
toa2.numbertoa = this.add.text(590, 240, number2, { fontSize: '32px', fill: '#000' });
toa3.numbertoa = this.add.text(790, 140, number3, { fontSize: '32px', fill: '#000' });
toa4.numbertoa = this.add.text(990, 240, number4, { fontSize: '32px', fill: '#000' });


}
function update()
{
  ylcircle1.x = toa1.x;
  ylcircle1.y = toa1.y -50;
  toa1.numbertoa.x = ylcircle1.x -10;
  toa1.numbertoa.y = ylcircle1.y -10;

  ylcircle2.x = toa2.x;
  ylcircle2.y = toa2.y -50;
  toa2.numbertoa.x = ylcircle2.x -10;
  toa2.numbertoa.y = ylcircle2.y -10;

  ylcircle3.x = toa3.x;
  ylcircle3.y = toa3.y -50;
  toa3.numbertoa.x = ylcircle3.x -10;
  toa3.numbertoa.y = ylcircle3.y -10;

  ylcircle4.x = toa4.x;
  ylcircle4.y = toa4.y -50;
  toa4.numbertoa.x = ylcircle4.x -10;
  toa4.numbertoa.y = ylcircle4.y -10;
  
  bl.x = train.x;
  bl.y = train.y -50;
  blueText.x = bl.x -10;
  blueText.y = bl.y -10;


  var i = 0;
  var distanceTemp;
  this.input.on('drag', function (pointer, gameObj, dragX, dragY) {

    gameObj.x = dragX;
    gameObj.y = dragY;
    distanceTemp = distanceOfTwoObj(color[i], gameObj.x, gameObj.y);


});
  this.input.on('dragend', function(pointer, gameObj, dragX, dragY) {
    if(distanceTemp < maxDistance){
        gameObj.x = color[i].x + 5;
        gameObj.y = 400;
        i++;
        gameObj.input.draggable= false;



       
    }
});

  if(toa4.x == color[3].x + 5 && toa4.y == 400){
    train.x -=5;
    toa1.x -= 5;
    toa2.x -= 5;
    toa3.x -= 5;

    


  }
  console.log(firstNumber);
}


function distanceOfTwoObj(colorI, toaX, toaY){
    return Math.sqrt(Math.pow(toaX-colorI.x,2)+Math.pow(colorI.y-toaY,2));
}
function creatNumber(){
    if(firstNumber <=4){
      number1 = firstNumber+1;
      number2 = firstNumber+2;
      number3 = firstNumber+3;
      number4 = firstNumber+4;
  }
  else  if(firstNumber > 5){
      number1 = firstNumber-1;
      number2 = firstNumber-2;
      number3 = firstNumber-3;
      number4 = firstNumber-4;
  }

  else {

    if (random % 2 == 0){
        number1 = firstNumber+1;
        number2 = firstNumber+2;
        number3 = firstNumber+3;
        number4 = firstNumber+4;

    }
    else {
        number1 = firstNumber-1;
        number2 = firstNumber-2;
        number3 = firstNumber-3;
        number4 = firstNumber-4;
    }
}

}

</script>
</body>
</html>
